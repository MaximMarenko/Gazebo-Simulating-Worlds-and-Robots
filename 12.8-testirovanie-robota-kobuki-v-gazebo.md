# 12.8 Тестирование робота Kobuki в Gazebo

Пакет Kobuki Gazebo идет вместе с миром, который включает в себя коллекцию столов с роботом и несколько шлакоблоков, сидящих сверху. Чтобы вывести Gazebo на экран с Kobuki и этим миром, остановите любые запущенные копии Gazebo и запустите следующий стартовый файл:

```text
$ roslaunch kobuki_gazebo kobuki_playground.launch
```

Когда робот и мир загружены, экран Gazebo должен выглядеть так:

![](.gitbook/assets/image%20%2810%29.png)

Как видите, мир состоит из нескольких столов с Kobuki и трех шлакоблоков, сидящих на столах.

Попробуйте нажать на кнопку перемещения или поворота на панели инструментов, а затем с помощью мыши \(щелчок левой кнопкой мыши\) переместить стол, блок или робота. Для поворота вида камеры используйте среднюю кнопку мыши. На изображении ниже показана сцена после перемещения одного из столов для создания проема:

![](.gitbook/assets/image%20%287%29.png)

Теперь мы можем попробовать управлять роботом с помощью стандартных команд ROS. Но сначала нам нужно знать разделы, используемые имитируемым роботом. Получите список текущих разделов, запустив команду:

```text
$ rostopic list
```

которая должна выдавать следующие результаты:

```text
/clock
/gazebo/link_states
/gazebo/model_states
/gazebo/parameter_descriptions
/gazebo/parameter_updates
/gazebo/set_link_state
/gazebo/set_model_state
/joint_states
/mobile_base/commands/motor_power
/mobile_base/commands/reset_odometry
/mobile_base/commands/velocity
/mobile_base/events/bumper
/mobile_base/events/cliff
/mobile_base/sensors/imu_data
/odom
/rosout
/rosout_agg
/tf
```

Здесь мы можем догадаться, что большинство разделов, связанных с Kobuki, живет в пространстве имён _/mobile\_base_. Раздел _/mobile\_base/commands/velocity_ принимает сообщения _Twist_ для управления базой. Разделы _/mobile\_base/events/cliff_ и _/mobile\_base/events/bumper_ регистрируют события с датчиков обрыва и удара. Стандартный _/odom_ раздел используется для публикации данных одометрии робота.

Так как Kobuki ожидает, что команды _Twist_ на тему _/mobile\_base/command/velocity_ вместо _/cmd\_vel_, попробуйте переместить робота вперед со скоростью 0.2 метра в секунду, выполнив следующую команду:

```text
$ rostopic pub -r 10 /mobile_base/commands/velocity geometry_msgs/Twist
'{linear: {x: 0.2}}'
```

Вы должны видеть, как робот перемещается по столу и падает с края, где мы создали промежуток. Чтобы удержать бедного робота от подпрыгивания на полу \(или от выезда из сцену, если он приземлился на колеса\), наберите Ctrl-C, чтобы завершить команду rostopic. затем щелкните меню Edit \(Редактировать\) в графическом интерфейсе Gazebo и выберите Reset Model Poses \(Сбросить позиции модели\). Так как настоящий робот Kobuki оснащен датчиками обрыва, почему имитированный робот съехал с края стола? Модель Kobuki's Gazebo включает в себя плагины для датчиков обрыва, и они действительно обнаруживают обрыв на краю стола, что мы увидим в следующей секции. Тем не менее, мы контролировали робота через раздел /mobile\_base/commands/velocity, который предназначен для перемещения робота в точности как мы просим, независимо от данных, поступающих от сенсоров обрыва или удара. После исследуя данные, возвращаемые имитационными датчиками, в следующем разделе мы узнаем. как управлять роботом более безопасно.





